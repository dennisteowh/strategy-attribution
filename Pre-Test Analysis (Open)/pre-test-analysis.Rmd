---
title: "Pre-test Analysis"
output:
  html_document:
    theme: readable
    toc: yes
    toc_depth: 3
    toc_float: true
    highlight: tango
    df_print: paged
fontsize: 18pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE)
```

```{r echo=FALSE, results='hide'}

library(psych)
library(ggplot2)
library(tidyverse)
library(effects)
## Library for the multiple comparisons
library(phia)
## Library to compute the effect sizes
library(sjstats)
library(lsr)
library(lavaan)
library(ggthemes)
library(tibble)
library(car)
library(olsrr)
library(dthelper)

load("attobo.pilot.RData")

```

```{r}


attobo.pilot$Age[attobo.pilot$Age == 1943] <- 75
attobo.pilot$Age[attobo.pilot$Age == 1984] <- 34
attobo.pilot$Age[attobo.pilot$Age == 1987] <- 31
attobo.pilot$Age[attobo.pilot$Age == 1988] <- 32
attobo.pilot$Age[attobo.pilot$Age == 1992] <- 26

summary(attobo.pilot$Age)

sd(attobo.pilot$Age, na.rm = T)

summary(factor(attobo.pilot$Gender))


```



# Descriptive Stats

```{r }

attobo.pilot %>%
  summarise(AptOutMean = mean(AptOut, na.rm = T),
            EffortOutMean = mean(EffortOut, na.rm = T),
            StratOutMean = mean(StratOut, na.rm = T),
            AptOutSD = sd(AptOut, na.rm = T),
            EffortOutSD = sd(EffortOut, na.rm = T),
            StratOutSD = sd(StratOut, na.rm = T))

attobo.pilot %>%
  summarise(AptVarMean = mean(AptVar, na.rm = T),
            EffortVarMean = mean(EffortVar, na.rm = T),
            StratVarMean = mean(StratVar, na.rm = T),
            AptVarSD = sd(AptVar, na.rm = T),
            EffortVarSD = sd(EffortVar, na.rm = T),
            StratVarSD = sd(StratVar, na.rm = T))

attobo.pilot %>%
  summarise(AptUnconMean = mean(AptUncon, na.rm = T),
            EffortUnconMean = mean(EffortUncon, na.rm = T),
            StratUnconMean = mean(StratUncon, na.rm = T),
            AptUnconSD = sd(AptUncon, na.rm = T),
            EffortUnconSD = sd(EffortUncon, na.rm = T),
            StratUnconSD = sd(StratUncon, na.rm = T))

attobo.dimensions <- attobo.pilot[, 2:19]

ggplot(data = gather(attobo.dimensions , factor_key = TRUE), aes(x = factor(value))) +
  geom_bar() + 
  facet_wrap(~ key,scales = "free", as.table = TRUE, nrow = 3) + xlab("") + 
  theme_bw()


```

###################################################################

# Attribution Patterns

## Locus

### Frequentist Estimates

```{r}

t.test(attobo.pilot$EffortOut, attobo.pilot$AptOut, paired = TRUE)

t.test(attobo.pilot$StratOut, attobo.pilot$AptOut,paired = TRUE)

t.test(attobo.pilot$StratOut, attobo.pilot$EffortOut, paired = TRUE)


```
